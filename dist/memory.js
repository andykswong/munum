const BYTES_PER_FLOAT64=8;let memoryManager;export function setMemoryManager(manager){memoryManager=manager}let usingFinalizationRegistry=true;export function useFinalizationRegistry(use){usingFinalizationRegistry=use}const registry=globalThis.FinalizationRegistry&&new FinalizationRegistry(([ptr,size])=>memoryManager.free(ptr,size));function register(arr){usingFinalizationRegistry&&registry?.register(arr,[arr.byteOffset,arr.length],arr)}function unregister(arr){usingFinalizationRegistry&&registry?.unregister(arr)}export class ManagedFloat64Array{constructor(byteOffset){this.byteOffset=byteOffset;register(this)}*[Symbol.iterator](){if(!this.valid){return}const view=memoryManager.view;const offset=this.byteOffset/BYTES_PER_FLOAT64|0;for(let i=0;i<this.length&&offset+i<view.length;i++){yield view[offset+i]}}[Symbol.dispose](){this.free()}at(index){if(index<0||index>=this.length){return}return memoryManager.view[this.byteOffset/BYTES_PER_FLOAT64+index|0]}setAt(index,value){if(index<0||index>=this.length){return}memoryManager.view[this.byteOffset/BYTES_PER_FLOAT64+index|0]=value}copy(from,dstOffset=0,srcOffset=0,length=Math.min(from.length-srcOffset,this.length-dstOffset)){const start=from.byteOffset/BYTES_PER_FLOAT64+srcOffset|0;memoryManager.view.copyWithin(this.byteOffset/BYTES_PER_FLOAT64+dstOffset|0,start,start+length)}set(array,offset=0){memoryManager.view.set(array,this.byteOffset/BYTES_PER_FLOAT64+offset|0)}free(){if(this.byteOffset>0){memoryManager.free(this.byteOffset,this.length);unregister(this);this.byteOffset=-Infinity}}get buffer(){return memoryManager.buffer}get byteLength(){return this.length*BYTES_PER_FLOAT64}get valid(){return this.byteOffset>=0}}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCWVRFU19QRVJfRkxPQVQ2NCIsIm1lbW9yeU1hbmFnZXIiLCJzZXRNZW1vcnlNYW5hZ2VyIiwibWFuYWdlciIsInVzaW5nRmluYWxpemF0aW9uUmVnaXN0cnkiLCJ1c2VGaW5hbGl6YXRpb25SZWdpc3RyeSIsInVzZSIsInJlZ2lzdHJ5IiwiZ2xvYmFsVGhpcyIsIkZpbmFsaXphdGlvblJlZ2lzdHJ5IiwicHRyIiwic2l6ZSIsImZyZWUiLCJyZWdpc3RlciIsImFyciIsImJ5dGVPZmZzZXQiLCJsZW5ndGgiLCJ1bnJlZ2lzdGVyIiwiTWFuYWdlZEZsb2F0NjRBcnJheSIsImNvbnN0cnVjdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJ2YWxpZCIsInZpZXciLCJvZmZzZXQiLCJpIiwiZGlzcG9zZSIsImF0IiwiaW5kZXgiLCJzZXRBdCIsInZhbHVlIiwiY29weSIsImZyb20iLCJkc3RPZmZzZXQiLCJzcmNPZmZzZXQiLCJNYXRoIiwibWluIiwic3RhcnQiLCJjb3B5V2l0aGluIiwic2V0IiwiYXJyYXkiLCJJbmZpbml0eSIsImJ1ZmZlciIsImJ5dGVMZW5ndGgiXSwic291cmNlcyI6WyIuLi9qcy9tZW1vcnkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQllURVNfUEVSX0ZMT0FUNjQgPSA4O1xuXG4vKiogQSBsaW5lYXIgbWVtb3J5IG1hbmFnZXIuICovXG5leHBvcnQgaW50ZXJmYWNlIE1lbW9yeU1hbmFnZXIge1xuICAvKiogVGhlIGFjdGl2ZSBtZW1vcnkgYnVmZmVyLiAqL1xuICByZWFkb25seSBidWZmZXI6IEFycmF5QnVmZmVyTGlrZTtcblxuICAvKiogVGhlIGFjdGl2ZSBmbG9hdDY0IG1lbW9yeSB2aWV3LiAqL1xuICByZWFkb25seSB2aWV3OiBGbG9hdDY0QXJyYXk7XG5cbiAgLyoqIEFsbG9jYXRlcyBnaXZlbiBzaXplIG9mIG1lbW9yeSBpbiB0aGUgbnVtYmVyIG9mIGZsb2F0NjQgYW5kIHJldHVybnMgdGhlIGJ5dGVPZmZzZXQgcG9pbnRpbmcgdG8gdGhlIG5ldyBtZW1vcnkuICovXG4gIGNyZWF0ZShzaXplOiBudW1iZXIpOiBudW1iZXI7XG5cbiAgLyoqIEZyZWVzIHRoZSBtZW1vcnkgYXQgZ2l2ZW4gYnl0ZU9mZnNldCBhbmQgc2l6ZSBpbiB0aGUgbnVtYmVyIG9mIGZsb2F0NjQuICovXG4gIGZyZWUoYnl0ZU9mZnNldDogbnVtYmVyLCBzaXplOiBudW1iZXIpOiB2b2lkO1xufVxuXG4vKiogVGhlIHtAbGluayBNZW1vcnlNYW5hZ2VyfSB0byB1c2UuICovXG5sZXQgbWVtb3J5TWFuYWdlcjogTWVtb3J5TWFuYWdlcjtcblxuLyoqIFNldHMgdGhlIHtAbGluayBNZW1vcnlNYW5hZ2VyfSB0byB1c2UuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0TWVtb3J5TWFuYWdlcihtYW5hZ2VyOiBNZW1vcnlNYW5hZ2VyKTogdm9pZCB7XG4gIG1lbW9yeU1hbmFnZXIgPSBtYW5hZ2VyO1xufVxuXG5sZXQgdXNpbmdGaW5hbGl6YXRpb25SZWdpc3RyeSA9IHRydWU7XG5cbi8qKiBTZXRzIGlmIEZpbmFsaXphdGlvblJlZ2lzdHJ5IHNob3VsZCBiZSB1c2VkIGZvciBhdXRvbWF0aWMgbWVtb3J5IGNsZWFudXAuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRmluYWxpemF0aW9uUmVnaXN0cnkodXNlOiBib29sZWFuKTogdm9pZCB7XG4gIHVzaW5nRmluYWxpemF0aW9uUmVnaXN0cnkgPSB1c2U7XG59XG5cbmNvbnN0IHJlZ2lzdHJ5ID0gZ2xvYmFsVGhpcy5GaW5hbGl6YXRpb25SZWdpc3RyeSAmJlxuICBuZXcgRmluYWxpemF0aW9uUmVnaXN0cnkoKFtwdHIsIHNpemVdOiBbbnVtYmVyLCBudW1iZXJdKSA9PiBtZW1vcnlNYW5hZ2VyLmZyZWUocHRyLCBzaXplKSk7XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyKGFycjogTWFuYWdlZEJ1ZmZlclZpZXcpOiB2b2lkIHtcbiAgdXNpbmdGaW5hbGl6YXRpb25SZWdpc3RyeSAmJiByZWdpc3RyeT8ucmVnaXN0ZXIoYXJyLCBbYXJyLmJ5dGVPZmZzZXQsIGFyci5sZW5ndGhdLCBhcnIpO1xufVxuXG5mdW5jdGlvbiB1bnJlZ2lzdGVyKGFycjogTWFuYWdlZEJ1ZmZlclZpZXcpOiB2b2lkIHtcbiAgdXNpbmdGaW5hbGl6YXRpb25SZWdpc3RyeSAmJiByZWdpc3RyeT8udW5yZWdpc3RlcihhcnIpO1xufVxuXG4vKiogQSB3cmFwcGVkIFR5cGVkQXJyYXkgdGhhdCByZXF1aXJlcyBleHBsaWNpdCBtZW1vcnkgbWFuYWdlbWVudC4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTWFuYWdlZEJ1ZmZlclZpZXc8TiBleHRlbmRzIG51bWJlciA9IG51bWJlcj4gZXh0ZW5kcyBBcnJheUJ1ZmZlclZpZXcsIERpc3Bvc2FibGUge1xuICAvKiogV2hldGhlciB0aGUgYXJyYXkgaXMgc3RpbGwgdmFsaWQuICovXG4gIHJlYWRvbmx5IHZhbGlkOiBib29sZWFuO1xuXG4gIC8qKiBUaGUgbGVuZ3RoIG9mIHRoZSBhcnJheS4gKi9cbiAgcmVhZG9ubHkgbGVuZ3RoOiBOO1xuXG4gIC8qKiBGcmVlcyB0aGUgYXJyYXkuICovXG4gIGZyZWUoKTogdm9pZDtcbn1cblxuLyoqIEEgbWFuYWdlZCBGbG9hdDY0QXJyYXkuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTWFuYWdlZEZsb2F0NjRBcnJheTxOIGV4dGVuZHMgbnVtYmVyID0gbnVtYmVyPlxuICBpbXBsZW1lbnRzIE1hbmFnZWRCdWZmZXJWaWV3PE4+LCBJdGVyYWJsZTxudW1iZXI+IHtcblxuICBwdWJsaWMgY29uc3RydWN0b3IocHVibGljIGJ5dGVPZmZzZXQ6IG51bWJlcikge1xuICAgIHJlZ2lzdGVyKHRoaXMpO1xuICB9XG5cbiAgcHVibGljICpbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYXRvcjxudW1iZXI+IHtcbiAgICBpZiAoIXRoaXMudmFsaWQpIHsgcmV0dXJuOyB9XG4gICAgY29uc3QgdmlldyA9IG1lbW9yeU1hbmFnZXIudmlldztcbiAgICBjb25zdCBvZmZzZXQgPSAodGhpcy5ieXRlT2Zmc2V0IC8gQllURVNfUEVSX0ZMT0FUNjQpIHwgMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGVuZ3RoICYmIG9mZnNldCArIGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB5aWVsZCB2aWV3W29mZnNldCArIGldO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBbU3ltYm9sLmRpc3Bvc2VdKCk6IHZvaWQge1xuICAgIHRoaXMuZnJlZSgpO1xuICB9XG5cbiAgLyoqIEdldHMgdGhlIHZhbHVlIGF0IGdpdmVuIGluZGV4LiAqL1xuICBwdWJsaWMgYXQoaW5kZXg6IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkgeyByZXR1cm47IH1cbiAgICByZXR1cm4gbWVtb3J5TWFuYWdlci52aWV3Wyh0aGlzLmJ5dGVPZmZzZXQgLyBCWVRFU19QRVJfRkxPQVQ2NCArIGluZGV4KSB8IDBdO1xuICB9XG5cbiAgLyoqIFNldHMgdGhlIHZhbHVlIGF0IGdpdmVuIGluZGV4LiAqL1xuICBwdWJsaWMgc2V0QXQoaW5kZXg6IG51bWJlciwgdmFsdWU6IG51bWJlcikge1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5sZW5ndGgpIHsgcmV0dXJuOyB9XG4gICAgbWVtb3J5TWFuYWdlci52aWV3Wyh0aGlzLmJ5dGVPZmZzZXQgLyBCWVRFU19QRVJfRkxPQVQ2NCArIGluZGV4KSB8IDBdID0gdmFsdWU7XG4gIH1cblxuICAvKiogQ29waWVzIGEgbWFuYWdlZCBhcnJheSB0byB0aGlzLiAqL1xuICBwdWJsaWMgY29weShcbiAgICBmcm9tOiBNYW5hZ2VkRmxvYXQ2NEFycmF5LCBkc3RPZmZzZXQgPSAwLCBzcmNPZmZzZXQgPSAwLFxuICAgIGxlbmd0aCA9IE1hdGgubWluKGZyb20ubGVuZ3RoIC0gc3JjT2Zmc2V0LCB0aGlzLmxlbmd0aCAtIGRzdE9mZnNldClcbiAgKSB7XG4gICAgY29uc3Qgc3RhcnQgPSAoZnJvbS5ieXRlT2Zmc2V0IC8gQllURVNfUEVSX0ZMT0FUNjQgKyBzcmNPZmZzZXQpIHwgMDtcbiAgICBtZW1vcnlNYW5hZ2VyLnZpZXcuY29weVdpdGhpbigodGhpcy5ieXRlT2Zmc2V0IC8gQllURVNfUEVSX0ZMT0FUNjQgKyBkc3RPZmZzZXQpIHwgMCwgc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKTtcbiAgfVxuXG4gIC8qKiBDb3BpZXMgYW4gYXJyYXkgdG8gdGhpcy4gKi9cbiAgcHVibGljIHNldChhcnJheTogQXJyYXlMaWtlPG51bWJlcj4sIG9mZnNldCA9IDApIHtcbiAgICBtZW1vcnlNYW5hZ2VyLnZpZXcuc2V0KGFycmF5LCAodGhpcy5ieXRlT2Zmc2V0IC8gQllURVNfUEVSX0ZMT0FUNjQgKyBvZmZzZXQpIHwgMCk7XG4gIH1cblxuICBwdWJsaWMgZnJlZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5ieXRlT2Zmc2V0ID4gMCkge1xuICAgICAgbWVtb3J5TWFuYWdlci5mcmVlKHRoaXMuYnl0ZU9mZnNldCwgdGhpcy5sZW5ndGgpO1xuICAgICAgdW5yZWdpc3Rlcih0aGlzKTtcbiAgICAgIHRoaXMuYnl0ZU9mZnNldCA9IC1JbmZpbml0eTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZ2V0IGJ1ZmZlcigpOiBBcnJheUJ1ZmZlckxpa2Uge1xuICAgIHJldHVybiBtZW1vcnlNYW5hZ2VyLmJ1ZmZlcjtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgYnl0ZUxlbmd0aCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmxlbmd0aCAqIEJZVEVTX1BFUl9GTE9BVDY0O1xuICB9XG5cbiAgcHVibGljIGdldCB2YWxpZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5ieXRlT2Zmc2V0ID49IDA7XG4gIH1cblxuICBwdWJsaWMgYWJzdHJhY3QgcmVhZG9ubHkgbGVuZ3RoOiBOO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxLQUFNLENBQUFBLGlCQUFpQixDQUFHLENB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