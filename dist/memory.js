const BYTES_PER_FLOAT64=8;let memoryManager;export function setMemoryManager(manager){memoryManager=manager}let usingFinalizationRegistry=true;export function useFinalizationRegistry(use){usingFinalizationRegistry=use}const registry=global.FinalizationRegistry&&new FinalizationRegistry(([ptr,size])=>memoryManager.free(ptr,size));function register(arr){usingFinalizationRegistry&&registry?.register(arr,[arr.byteOffset,arr.length],arr)}function unregister(arr){usingFinalizationRegistry&&registry?.unregister(arr)}export class ManagedFloat64Array{constructor(byteOffset){this.byteOffset=byteOffset;register(this)}*[Symbol.iterator](){if(!this.valid){return}const view=memoryManager.view;const offset=this.byteOffset/BYTES_PER_FLOAT64|0;for(let i=0;i<this.length&&offset+i<view.length;i++){yield view[offset+i]}}[Symbol.dispose](){this.free()}at(index){if(index<0||index>=this.length){return}return memoryManager.view.at(this.byteOffset/BYTES_PER_FLOAT64+index|0)}copy(from,offset=0,length=Math.min(from.length,this.length-offset)){const start=from.byteOffset/BYTES_PER_FLOAT64|0;memoryManager.view.copyWithin(this.byteOffset/BYTES_PER_FLOAT64+offset|0,start,start+length)}set(array,offset=0){memoryManager.view.set(array,this.byteOffset/BYTES_PER_FLOAT64+offset|0)}free(){if(this.byteOffset>0){memoryManager.free(this.byteOffset,this.length);unregister(this);this.byteOffset=-Infinity}}get buffer(){return memoryManager.buffer}get byteLength(){return this.length*BYTES_PER_FLOAT64}get valid(){return this.byteOffset>=0}}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCWVRFU19QRVJfRkxPQVQ2NCIsIm1lbW9yeU1hbmFnZXIiLCJzZXRNZW1vcnlNYW5hZ2VyIiwibWFuYWdlciIsInVzaW5nRmluYWxpemF0aW9uUmVnaXN0cnkiLCJ1c2VGaW5hbGl6YXRpb25SZWdpc3RyeSIsInVzZSIsInJlZ2lzdHJ5IiwiZ2xvYmFsIiwiRmluYWxpemF0aW9uUmVnaXN0cnkiLCJwdHIiLCJzaXplIiwiZnJlZSIsInJlZ2lzdGVyIiwiYXJyIiwiYnl0ZU9mZnNldCIsImxlbmd0aCIsInVucmVnaXN0ZXIiLCJNYW5hZ2VkRmxvYXQ2NEFycmF5IiwiY29uc3RydWN0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsInZhbGlkIiwidmlldyIsIm9mZnNldCIsImkiLCJkaXNwb3NlIiwiYXQiLCJpbmRleCIsImNvcHkiLCJmcm9tIiwiTWF0aCIsIm1pbiIsInN0YXJ0IiwiY29weVdpdGhpbiIsInNldCIsImFycmF5IiwiSW5maW5pdHkiLCJidWZmZXIiLCJieXRlTGVuZ3RoIl0sInNvdXJjZXMiOlsiLi4vanMvbWVtb3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEJZVEVTX1BFUl9GTE9BVDY0ID0gODtcblxuLyoqIEEgbGluZWFyIG1lbW9yeSBtYW5hZ2VyLiAqL1xuZXhwb3J0IGludGVyZmFjZSBNZW1vcnlNYW5hZ2VyIHtcbiAgLyoqIFRoZSBhY3RpdmUgbWVtb3J5IGJ1ZmZlci4gKi9cbiAgcmVhZG9ubHkgYnVmZmVyOiBBcnJheUJ1ZmZlckxpa2U7XG5cbiAgLyoqIFRoZSBhY3RpdmUgZmxvYXQ2NCBtZW1vcnkgdmlldy4gKi9cbiAgcmVhZG9ubHkgdmlldzogRmxvYXQ2NEFycmF5O1xuXG4gIC8qKiBBbGxvY2F0ZXMgZ2l2ZW4gc2l6ZSBvZiBtZW1vcnkgaW4gdGhlIG51bWJlciBvZiBmbG9hdDY0IGFuZCByZXR1cm5zIHRoZSBieXRlT2Zmc2V0IHBvaW50aW5nIHRvIHRoZSBuZXcgbWVtb3J5LiAqL1xuICBjcmVhdGUoc2l6ZTogbnVtYmVyKTogbnVtYmVyO1xuXG4gIC8qKiBGcmVlcyB0aGUgbWVtb3J5IGF0IGdpdmVuIGJ5dGVPZmZzZXQgYW5kIHNpemUgaW4gdGhlIG51bWJlciBvZiBmbG9hdDY0LiAqL1xuICBmcmVlKGJ5dGVPZmZzZXQ6IG51bWJlciwgc2l6ZTogbnVtYmVyKTogdm9pZDtcbn1cblxuLyoqIFRoZSB7QGxpbmsgTWVtb3J5TWFuYWdlcn0gdG8gdXNlLiAqL1xubGV0IG1lbW9yeU1hbmFnZXI6IE1lbW9yeU1hbmFnZXI7XG5cbi8qKiBTZXRzIHRoZSB7QGxpbmsgTWVtb3J5TWFuYWdlcn0gdG8gdXNlLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldE1lbW9yeU1hbmFnZXIobWFuYWdlcjogTWVtb3J5TWFuYWdlcik6IHZvaWQge1xuICBtZW1vcnlNYW5hZ2VyID0gbWFuYWdlcjtcbn1cblxubGV0IHVzaW5nRmluYWxpemF0aW9uUmVnaXN0cnkgPSB0cnVlO1xuXG4vKiogU2V0cyBpZiBGaW5hbGl6YXRpb25SZWdpc3RyeSBzaG91bGQgYmUgdXNlZCBmb3IgYXV0b21hdGljIG1lbW9yeSBjbGVhbnVwLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUZpbmFsaXphdGlvblJlZ2lzdHJ5KHVzZTogYm9vbGVhbik6IHZvaWQge1xuICB1c2luZ0ZpbmFsaXphdGlvblJlZ2lzdHJ5ID0gdXNlO1xufVxuXG5jb25zdCByZWdpc3RyeSA9IGdsb2JhbC5GaW5hbGl6YXRpb25SZWdpc3RyeSAmJlxuICBuZXcgRmluYWxpemF0aW9uUmVnaXN0cnkoKFtwdHIsIHNpemVdOiBbbnVtYmVyLCBudW1iZXJdKSA9PiBtZW1vcnlNYW5hZ2VyLmZyZWUocHRyLCBzaXplKSk7XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyKGFycjogTWFuYWdlZEJ1ZmZlclZpZXcpOiB2b2lkIHtcbiAgdXNpbmdGaW5hbGl6YXRpb25SZWdpc3RyeSAmJiByZWdpc3RyeT8ucmVnaXN0ZXIoYXJyLCBbYXJyLmJ5dGVPZmZzZXQsIGFyci5sZW5ndGhdLCBhcnIpO1xufVxuXG5mdW5jdGlvbiB1bnJlZ2lzdGVyKGFycjogTWFuYWdlZEJ1ZmZlclZpZXcpOiB2b2lkIHtcbiAgdXNpbmdGaW5hbGl6YXRpb25SZWdpc3RyeSAmJiByZWdpc3RyeT8udW5yZWdpc3RlcihhcnIpO1xufVxuXG4vKiogQSB3cmFwcGVkIFR5cGVkQXJyYXkgdGhhdCByZXF1aXJlcyBleHBsaWNpdCBtZW1vcnkgbWFuYWdlbWVudC4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTWFuYWdlZEJ1ZmZlclZpZXc8TiBleHRlbmRzIG51bWJlciA9IG51bWJlcj4gZXh0ZW5kcyBBcnJheUJ1ZmZlclZpZXcsIERpc3Bvc2FibGUge1xuICAvKiogV2hldGhlciB0aGUgYXJyYXkgaXMgc3RpbGwgdmFsaWQuICovXG4gIHJlYWRvbmx5IHZhbGlkOiBib29sZWFuO1xuXG4gIC8qKiBUaGUgbGVuZ3RoIG9mIHRoZSBhcnJheS4gKi9cbiAgcmVhZG9ubHkgbGVuZ3RoOiBOO1xuXG4gIC8qKiBGcmVlcyB0aGUgYXJyYXkuICovXG4gIGZyZWUoKTogdm9pZDtcbn1cblxuLyoqIEEgbWFuYWdlZCBGbG9hdDY0QXJyYXkuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTWFuYWdlZEZsb2F0NjRBcnJheTxOIGV4dGVuZHMgbnVtYmVyID0gbnVtYmVyPlxuICBpbXBsZW1lbnRzIE1hbmFnZWRCdWZmZXJWaWV3PE4+LCBJdGVyYWJsZTxudW1iZXI+IHtcblxuICBwdWJsaWMgY29uc3RydWN0b3IocHVibGljIGJ5dGVPZmZzZXQ6IG51bWJlcikge1xuICAgIHJlZ2lzdGVyKHRoaXMpO1xuICB9XG5cbiAgcHVibGljICpbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYXRvcjxudW1iZXI+IHtcbiAgICBpZiAoIXRoaXMudmFsaWQpIHsgcmV0dXJuOyB9XG4gICAgY29uc3QgdmlldyA9IG1lbW9yeU1hbmFnZXIudmlldztcbiAgICBjb25zdCBvZmZzZXQgPSAodGhpcy5ieXRlT2Zmc2V0IC8gQllURVNfUEVSX0ZMT0FUNjQpIHwgMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGVuZ3RoICYmIG9mZnNldCArIGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB5aWVsZCB2aWV3W29mZnNldCArIGldO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBbU3ltYm9sLmRpc3Bvc2VdKCk6IHZvaWQge1xuICAgIHRoaXMuZnJlZSgpO1xuICB9XG5cbiAgLyoqIEdldHMgdGhlIHZhbHVlIGF0IGdpdmVuIGluZGV4LiAqL1xuICBwdWJsaWMgYXQoaW5kZXg6IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkgeyByZXR1cm47IH1cbiAgICByZXR1cm4gbWVtb3J5TWFuYWdlci52aWV3LmF0KCh0aGlzLmJ5dGVPZmZzZXQgLyBCWVRFU19QRVJfRkxPQVQ2NCArIGluZGV4KSB8IDApO1xuICB9XG5cbiAgLyoqIENvcGllcyBhIG1hbmFnZWQgYXJyYXkgdG8gdGhpcy4gKi9cbiAgcHVibGljIGNvcHkoZnJvbTogTWFuYWdlZEZsb2F0NjRBcnJheSwgb2Zmc2V0ID0gMCwgbGVuZ3RoID0gTWF0aC5taW4oZnJvbS5sZW5ndGgsIHRoaXMubGVuZ3RoIC0gb2Zmc2V0KSkge1xuICAgIGNvbnN0IHN0YXJ0ID0gKGZyb20uYnl0ZU9mZnNldCAvIEJZVEVTX1BFUl9GTE9BVDY0KSB8IDA7XG4gICAgbWVtb3J5TWFuYWdlci52aWV3LmNvcHlXaXRoaW4oKHRoaXMuYnl0ZU9mZnNldCAvIEJZVEVTX1BFUl9GTE9BVDY0ICsgb2Zmc2V0KSB8IDAsIHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7XG4gIH1cblxuICAvKiogQ29waWVzIGFuIGFycmF5IHRvIHRoaXMuICovXG4gIHB1YmxpYyBzZXQoYXJyYXk6IEFycmF5TGlrZTxudW1iZXI+LCBvZmZzZXQgPSAwKSB7XG4gICAgbWVtb3J5TWFuYWdlci52aWV3LnNldChhcnJheSwgKHRoaXMuYnl0ZU9mZnNldCAvIEJZVEVTX1BFUl9GTE9BVDY0ICsgb2Zmc2V0KSB8IDApO1xuICB9XG5cbiAgcHVibGljIGZyZWUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYnl0ZU9mZnNldCA+IDApIHtcbiAgICAgIG1lbW9yeU1hbmFnZXIuZnJlZSh0aGlzLmJ5dGVPZmZzZXQsIHRoaXMubGVuZ3RoKTtcbiAgICAgIHVucmVnaXN0ZXIodGhpcyk7XG4gICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAtSW5maW5pdHk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldCBidWZmZXIoKTogQXJyYXlCdWZmZXJMaWtlIHtcbiAgICByZXR1cm4gbWVtb3J5TWFuYWdlci5idWZmZXI7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGJ5dGVMZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGggKiBCWVRFU19QRVJfRkxPQVQ2NDtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgdmFsaWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldCA+PSAwO1xuICB9XG5cbiAgcHVibGljIGFic3RyYWN0IHJlYWRvbmx5IGxlbmd0aDogTjtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUEsS0FBTSxDQUFBQSxpQkFBaUIsQ0FBRyxDQUFDLENBa0IzQixHQUFJLENBQUFDLGFBQTRCLENBR2hDLE1BQU8sU0FBUyxDQUFBQyxnQkFBZ0JBLENBQUNDLE9BQXNCLENBQVEsQ0FDN0RGLGFBQWEsQ0FBR0UsT0FDbEIsQ0FFQSxHQUFJLENBQUFDLHlCQUF5QixDQUFHLElBQUksQ0FHcEMsTUFBTyxTQUFTLENBQUFDLHVCQUF1QkEsQ0FBQ0MsR0FBWSxDQUFRLENBQzFERix5QkFBeUIsQ0FBR0UsR0FDOUIsQ0FFQSxLQUFNLENBQUFDLFFBQVEsQ0FBR0MsTUFBTSxDQUFDQyxvQkFBb0IsRUFDMUMsR0FBSSxDQUFBQSxvQkFBb0IsQ0FBQyxDQUFDLENBQUNDLEdBQUcsQ0FBRUMsSUFBSSxDQUFtQixHQUFLVixhQUFhLENBQUNXLElBQUksQ0FBQ0YsR0FBRyxDQUFFQyxJQUFJLENBQUMsQ0FBQyxDQUU1RixRQUFTLENBQUFFLFFBQVFBLENBQUNDLEdBQXNCLENBQVEsQ0FDOUNWLHlCQUF5QixFQUFJRyxRQUFRLEVBQUVNLFFBQVEsQ0FBQ0MsR0FBRyxDQUFFLENBQUNBLEdBQUcsQ0FBQ0MsVUFBVSxDQUFFRCxHQUFHLENBQUNFLE1BQU0sQ0FBQyxDQUFFRixHQUFHLENBQ3hGLENBRUEsUUFBUyxDQUFBRyxVQUFVQSxDQUFDSCxHQUFzQixDQUFRLENBQ2hEVix5QkFBeUIsRUFBSUcsUUFBUSxFQUFFVSxVQUFVLENBQUNILEdBQUcsQ0FDdkQsQ0FlQSxNQUFPLE1BQWUsQ0FBQUksbUJBQzhCLENBRTNDQyxXQUFXQSxDQUFRSixVQUFrQixDQUFFLE1BQXBCQSxVQUFrQixDQUFsQkEsVUFBa0IsQ0FDMUNGLFFBQVEsQ0FBQyxJQUFJLENBQ2YsQ0FFQSxFQUFTTyxNQUFNLENBQUNDLFFBQVEsR0FBc0IsQ0FDNUMsR0FBSSxDQUFDLElBQUksQ0FBQ0MsS0FBSyxDQUFFLENBQUUsTUFBUSxDQUMzQixLQUFNLENBQUFDLElBQUksQ0FBR3RCLGFBQWEsQ0FBQ3NCLElBQUksQ0FDL0IsS0FBTSxDQUFBQyxNQUFNLENBQUksSUFBSSxDQUFDVCxVQUFVLENBQUdmLGlCQUFpQixDQUFJLENBQUMsQ0FDeEQsSUFBSyxHQUFJLENBQUF5QixDQUFDLENBQUcsQ0FBQyxDQUFFQSxDQUFDLENBQUcsSUFBSSxDQUFDVCxNQUFNLEVBQUlRLE1BQU0sQ0FBR0MsQ0FBQyxDQUFHRixJQUFJLENBQUNQLE1BQU0sQ0FBRVMsQ0FBQyxFQUFFLENBQUUsQ0FDaEUsS0FBTSxDQUFBRixJQUFJLENBQUNDLE1BQU0sQ0FBR0MsQ0FBQyxDQUN2QixDQUNGLENBRUEsQ0FBUUwsTUFBTSxDQUFDTSxPQUFPLEdBQVUsQ0FDOUIsSUFBSSxDQUFDZCxJQUFJLENBQUMsQ0FDWixDQUdPZSxFQUFFQSxDQUFDQyxLQUFhLENBQXNCLENBQzNDLEdBQUlBLEtBQUssQ0FBRyxDQUFDLEVBQUlBLEtBQUssRUFBSSxJQUFJLENBQUNaLE1BQU0sQ0FBRSxDQUFFLE1BQVEsQ0FDakQsTUFBTyxDQUFBZixhQUFhLENBQUNzQixJQUFJLENBQUNJLEVBQUUsQ0FBRSxJQUFJLENBQUNaLFVBQVUsQ0FBR2YsaUJBQWlCLENBQUc0QixLQUFLLENBQUksQ0FBQyxDQUNoRixDQUdPQyxJQUFJQSxDQUFDQyxJQUF5QixDQUFFTixNQUFNLENBQUcsQ0FBQyxDQUFFUixNQUFNLENBQUdlLElBQUksQ0FBQ0MsR0FBRyxDQUFDRixJQUFJLENBQUNkLE1BQU0sQ0FBRSxJQUFJLENBQUNBLE1BQU0sQ0FBR1EsTUFBTSxDQUFDLENBQUUsQ0FDdkcsS0FBTSxDQUFBUyxLQUFLLENBQUlILElBQUksQ0FBQ2YsVUFBVSxDQUFHZixpQkFBaUIsQ0FBSSxDQUFDLENBQ3ZEQyxhQUFhLENBQUNzQixJQUFJLENBQUNXLFVBQVUsQ0FBRSxJQUFJLENBQUNuQixVQUFVLENBQUdmLGlCQUFpQixDQUFHd0IsTUFBTSxDQUFJLENBQUMsQ0FBRVMsS0FBSyxDQUFFQSxLQUFLLENBQUdqQixNQUFNLENBQ3pHLENBR09tQixHQUFHQSxDQUFDQyxLQUF3QixDQUFFWixNQUFNLENBQUcsQ0FBQyxDQUFFLENBQy9DdkIsYUFBYSxDQUFDc0IsSUFBSSxDQUFDWSxHQUFHLENBQUNDLEtBQUssQ0FBRyxJQUFJLENBQUNyQixVQUFVLENBQUdmLGlCQUFpQixDQUFHd0IsTUFBTSxDQUFJLENBQUMsQ0FDbEYsQ0FFT1osSUFBSUEsQ0FBQSxDQUFTLENBQ2xCLEdBQUksSUFBSSxDQUFDRyxVQUFVLENBQUcsQ0FBQyxDQUFFLENBQ3ZCZCxhQUFhLENBQUNXLElBQUksQ0FBQyxJQUFJLENBQUNHLFVBQVUsQ0FBRSxJQUFJLENBQUNDLE1BQU0sQ0FBQyxDQUNoREMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUNoQixJQUFJLENBQUNGLFVBQVUsQ0FBRyxDQUFDc0IsUUFDckIsQ0FDRixDQUVBLEdBQVcsQ0FBQUMsTUFBTUEsQ0FBQSxDQUFvQixDQUNuQyxNQUFPLENBQUFyQyxhQUFhLENBQUNxQyxNQUN2QixDQUVBLEdBQVcsQ0FBQUMsVUFBVUEsQ0FBQSxDQUFXLENBQzlCLE1BQU8sS0FBSSxDQUFDdkIsTUFBTSxDQUFHaEIsaUJBQ3ZCLENBRUEsR0FBVyxDQUFBc0IsS0FBS0EsQ0FBQSxDQUFZLENBQzFCLE1BQU8sS0FBSSxDQUFDUCxVQUFVLEVBQUksQ0FDNUIsQ0FHRiIsImlnbm9yZUxpc3QiOltdfQ==