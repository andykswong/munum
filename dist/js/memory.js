import{ManagedFloat64Array,setMemoryManager,useFinalizationRegistry}from"../memory.js";export const BYTES_PER_FLOAT64=8;const memory=new WebAssembly.Memory({initial:0});const freeList={};let view=new Float64Array(memory.buffer);let next=0;export const memoryManager={get buffer(){return memory.buffer},get view(){return view},create:function(size){if(freeList[size]){const offset=freeList[size]-1;freeList[size]=view[offset];return offset*BYTES_PER_FLOAT64}if(next+size>view.length){memory.grow(1);view=new Float64Array(memory.buffer)}const offset=next;next+=size;return offset*BYTES_PER_FLOAT64},free:function(byteOffset,size){const offset=Math.ceil(byteOffset/BYTES_PER_FLOAT64);if(offset+size>view.length){return}view[offset]=freeList[size]||0;freeList[size]=offset+1}};setMemoryManager(memoryManager);export{ManagedFloat64Array,setMemoryManager,useFinalizationRegistry};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNYW5hZ2VkRmxvYXQ2NEFycmF5Iiwic2V0TWVtb3J5TWFuYWdlciIsInVzZUZpbmFsaXphdGlvblJlZ2lzdHJ5IiwiQllURVNfUEVSX0ZMT0FUNjQiLCJtZW1vcnkiLCJXZWJBc3NlbWJseSIsIk1lbW9yeSIsImluaXRpYWwiLCJmcmVlTGlzdCIsInZpZXciLCJGbG9hdDY0QXJyYXkiLCJidWZmZXIiLCJuZXh0IiwibWVtb3J5TWFuYWdlciIsImNyZWF0ZSIsInNpemUiLCJvZmZzZXQiLCJsZW5ndGgiLCJncm93IiwiZnJlZSIsImJ5dGVPZmZzZXQiLCJNYXRoIiwiY2VpbCJdLCJzb3VyY2VzIjpbIi4uLy4uL2pzL2pzL21lbW9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYW5hZ2VkRmxvYXQ2NEFycmF5LCBNZW1vcnlNYW5hZ2VyLCBzZXRNZW1vcnlNYW5hZ2VyLCB1c2VGaW5hbGl6YXRpb25SZWdpc3RyeSB9IGZyb20gJy4uL21lbW9yeS50cyc7XG5cbmV4cG9ydCBjb25zdCBCWVRFU19QRVJfRkxPQVQ2NCA9IDg7XG5jb25zdCBtZW1vcnkgPSBuZXcgV2ViQXNzZW1ibHkuTWVtb3J5KHsgaW5pdGlhbDogMCB9KTtcbmNvbnN0IGZyZWVMaXN0OiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+ID0ge307XG5sZXQgdmlldyA9IG5ldyBGbG9hdDY0QXJyYXkobWVtb3J5LmJ1ZmZlcik7XG5sZXQgbmV4dCA9IDA7XG5cbi8qKiBGcmVlLWxpc3QgYWxsb2NhdG9yIHVzaW5nIFdBU00gZ3Jvd2FibGUgbWVtb3J5LiAqL1xuZXhwb3J0IGNvbnN0IG1lbW9yeU1hbmFnZXI6IE1lbW9yeU1hbmFnZXIgPSB7XG4gIGdldCBidWZmZXIoKSB7XG4gICAgcmV0dXJuIG1lbW9yeS5idWZmZXI7XG4gIH0sXG4gIGdldCB2aWV3KCkge1xuICAgIHJldHVybiB2aWV3O1xuICB9LFxuICBjcmVhdGU6IGZ1bmN0aW9uIChzaXplOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmIChmcmVlTGlzdFtzaXplXSkge1xuICAgICAgY29uc3Qgb2Zmc2V0ID0gZnJlZUxpc3Rbc2l6ZV0gLSAxO1xuICAgICAgZnJlZUxpc3Rbc2l6ZV0gPSB2aWV3W29mZnNldF07XG4gICAgICByZXR1cm4gb2Zmc2V0ICogQllURVNfUEVSX0ZMT0FUNjQ7XG4gICAgfVxuXG4gICAgaWYgKG5leHQgKyBzaXplID4gdmlldy5sZW5ndGgpIHtcbiAgICAgIG1lbW9yeS5ncm93KDEpO1xuICAgICAgdmlldyA9IG5ldyBGbG9hdDY0QXJyYXkobWVtb3J5LmJ1ZmZlcik7XG4gICAgfVxuXG4gICAgY29uc3Qgb2Zmc2V0ID0gbmV4dDtcbiAgICBuZXh0ICs9IHNpemU7XG4gICAgcmV0dXJuIG9mZnNldCAqIEJZVEVTX1BFUl9GTE9BVDY0O1xuICB9LFxuICBmcmVlOiBmdW5jdGlvbiAoYnl0ZU9mZnNldDogbnVtYmVyLCBzaXplOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBvZmZzZXQgPSBNYXRoLmNlaWwoYnl0ZU9mZnNldCAvIEJZVEVTX1BFUl9GTE9BVDY0KTtcbiAgICBpZiAob2Zmc2V0ICsgc2l6ZSA+IHZpZXcubGVuZ3RoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZpZXdbb2Zmc2V0XSA9IGZyZWVMaXN0W3NpemVdIHx8IDA7XG4gICAgZnJlZUxpc3Rbc2l6ZV0gPSBvZmZzZXQgKyAxO1xuICB9XG59O1xuXG5zZXRNZW1vcnlNYW5hZ2VyKG1lbW9yeU1hbmFnZXIpO1xuXG5leHBvcnQgdHlwZSB7IE1lbW9yeU1hbmFnZXIgfTtcbmV4cG9ydCB7IE1hbmFnZWRGbG9hdDY0QXJyYXksIHNldE1lbW9yeU1hbmFnZXIsIHVzZUZpbmFsaXphdGlvblJlZ2lzdHJ5IH07XG4iXSwibWFwcGluZ3MiOiJPQUFTQSxtQkFBbUIsQ0FBaUJDLGdCQUFnQixDQUFFQyx1QkFBdUIsb0JBRXRGLE1BQU8sTUFBTSxDQUFBQyxpQkFBaUIsQ0FBRyxDQUFDLENBQ2xDLEtBQU0sQ0FBQUMsTUFBTSxDQUFHLEdBQUksQ0FBQUMsV0FBVyxDQUFDQyxNQUFNLENBQUMsQ0FBRUMsT0FBTyxDQUFFLENBQUUsQ0FBQyxDQUFDLENBQ3JELEtBQU0sQ0FBQUMsUUFBZ0MsQ0FBRyxDQUFDLENBQUMsQ0FDM0MsR0FBSSxDQUFBQyxJQUFJLENBQUcsR0FBSSxDQUFBQyxZQUFZLENBQUNOLE1BQU0sQ0FBQ08sTUFBTSxDQUFDLENBQzFDLEdBQUksQ0FBQUMsSUFBSSxDQUFHLENBQUMsQ0FHWixNQUFPLE1BQU0sQ0FBQUMsYUFBNEIsQ0FBRyxDQUMxQyxHQUFJLENBQUFGLE1BQU1BLENBQUEsQ0FBRyxDQUNYLE1BQU8sQ0FBQVAsTUFBTSxDQUFDTyxNQUNoQixDQUFDLENBQ0QsR0FBSSxDQUFBRixJQUFJQSxDQUFBLENBQUcsQ0FDVCxNQUFPLENBQUFBLElBQ1QsQ0FBQyxDQUNESyxNQUFNLENBQUUsUUFBQUEsQ0FBVUMsSUFBWSxDQUFVLENBQ3RDLEdBQUlQLFFBQVEsQ0FBQ08sSUFBSSxDQUFDLENBQUUsQ0FDbEIsS0FBTSxDQUFBQyxNQUFNLENBQUdSLFFBQVEsQ0FBQ08sSUFBSSxDQUFDLENBQUcsQ0FBQyxDQUNqQ1AsUUFBUSxDQUFDTyxJQUFJLENBQUMsQ0FBR04sSUFBSSxDQUFDTyxNQUFNLENBQUMsQ0FDN0IsTUFBTyxDQUFBQSxNQUFNLENBQUdiLGlCQUNsQixDQUVBLEdBQUlTLElBQUksQ0FBR0csSUFBSSxDQUFHTixJQUFJLENBQUNRLE1BQU0sQ0FBRSxDQUM3QmIsTUFBTSxDQUFDYyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQ2RULElBQUksQ0FBRyxHQUFJLENBQUFDLFlBQVksQ0FBQ04sTUFBTSxDQUFDTyxNQUFNLENBQ3ZDLENBRUEsS0FBTSxDQUFBSyxNQUFNLENBQUdKLElBQUksQ0FDbkJBLElBQUksRUFBSUcsSUFBSSxDQUNaLE1BQU8sQ0FBQUMsTUFBTSxDQUFHYixpQkFDbEIsQ0FBQyxDQUNEZ0IsSUFBSSxDQUFFLFFBQUFBLENBQVVDLFVBQWtCLENBQUVMLElBQVksQ0FBUSxDQUN0RCxLQUFNLENBQUFDLE1BQU0sQ0FBR0ssSUFBSSxDQUFDQyxJQUFJLENBQUNGLFVBQVUsQ0FBR2pCLGlCQUFpQixDQUFDLENBQ3hELEdBQUlhLE1BQU0sQ0FBR0QsSUFBSSxDQUFHTixJQUFJLENBQUNRLE1BQU0sQ0FBRSxDQUMvQixNQUNGLENBQ0FSLElBQUksQ0FBQ08sTUFBTSxDQUFDLENBQUdSLFFBQVEsQ0FBQ08sSUFBSSxDQUFDLEVBQUksQ0FBQyxDQUNsQ1AsUUFBUSxDQUFDTyxJQUFJLENBQUMsQ0FBR0MsTUFBTSxDQUFHLENBQzVCLENBQ0YsQ0FBQyxDQUVEZixnQkFBZ0IsQ0FBQ1ksYUFBYSxDQUFDLENBRy9CLE9BQVNiLG1CQUFtQixDQUFFQyxnQkFBZ0IsQ0FBRUMsdUJBQXVCIiwiaWdub3JlTGlzdCI6W119